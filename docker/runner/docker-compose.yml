version: "3"

# Parameters:
# -------------
#   - APP:      osd (OpenSearch Dashboards) or kbn (Kibana)
#   - VERSION:  OpenSearch Dashboards / Kibana version
#   - REPO:     Path to the Fortishield app local repository
#   - CMD:      yarn command to execute in the container
#   - ARGS:     (optional) Additional CLI options of the command

services:
  test_runner:
    container_name: runner
    image:  quay.io/fortishield/$APP-dev:$VERSION
    working_dir: /home/node/kbn/plugins/fortishield
    volumes:
      - $REPO:/home/node/kbn/plugins/fortishield
    command: /bin/bash -c '
        yarn;
        yarn $CMD $ARGS
      '